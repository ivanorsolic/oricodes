<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.62.1" />
    <meta name="description" content="Ori&#39;s self-driving RC car">
<meta name="author" content="ori">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Master recipe: How train your model :: Ori Codes</title>

    
    <link href="/css/nucleus.css" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css" rel="stylesheet">
    <link href="/css/hybrid.css" rel="stylesheet">
    <link href="/css/featherlight.min.css" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css" rel="stylesheet">
    <link href="/css/auto-complete.css" rel="stylesheet">
    
    <link href="/css/theme.css" rel="stylesheet">
    <link href="/css/hugo-theme.css" rel="stylesheet">
    
      <link href="/css/theme-mine.css" rel="stylesheet">
    

    <script src="/js/jquery-3.3.1.min.js"></script>
    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
   "HTML-CSS": { linebreaks: { automatic: true } },
           SVG: { linebreaks: { automatic: true } }
  });
  </script>
<script type="text/javascript" async
  src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['++','++']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
  }
  });
  MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>
    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
        :not(pre) > code + span.copy-to-clipboard {
            display: none;
        }
      
    </style>
    
  </head>
  <body class="" data-url="/draft-and-todo/how-to-train-your-model/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="https://ori.codes/">
  <img src="/images/logo.png">
</a>

	  2310 words.<br>
	  Reading time: 11 minutes.
	  
    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js"></script>
<script type="text/javascript" src="/js/auto-complete.js"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/ori.codes\/";
    
</script>
<script type="text/javascript" src="/js/search.js"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/rc-car/" title="RC Cars: a primer" class="dd-item 
        
        
        
        ">
      <a href="/rc-car/">
          <b>1. </b>RC Cars: a primer
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/rc-car/parts_list/" title="Parts: an overview" class="dd-item ">
        <a href="/rc-car/parts_list/">
        Parts: an overview
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/rc-car/scale/" title="Scale" class="dd-item ">
        <a href="/rc-car/scale/">
        Scale
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/rc-car/body_type/" title="RC Car body types" class="dd-item ">
        <a href="/rc-car/body_type/">
        Body type
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/rc-car/electric_motors/" title="Electric motors" class="dd-item ">
        <a href="/rc-car/electric_motors/">
        Electric motors
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/rc-car/servo/" title="Steering servo" class="dd-item ">
        <a href="/rc-car/servo/">
        Servo
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/rc-car/electronic_speed_controller/" title="Electronic Speed Controller" class="dd-item ">
        <a href="/rc-car/electronic_speed_controller/">
        ESC
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/rc-car/receiver/" title="Receiver" class="dd-item ">
        <a href="/rc-car/receiver/">
        Receiver
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/rc-car/batteries/" title="Batteries" class="dd-item ">
        <a href="/rc-car/batteries/">
        Batteries
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/hardware/" title="Hardware" class="dd-item 
        
        
        
        ">
      <a href="/hardware/">
          <b>2. </b>Hardware
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/hardware/inventory/" title="Hardware inventory" class="dd-item ">
        <a href="/hardware/inventory/">
        Inventory: stuff you&#39;ll need
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/hardware/building-the-car/" title="Assembling the RC Car" class="dd-item ">
        <a href="/hardware/building-the-car/">
        Assembling the RC Car
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/hardware/mounting-plates/" title="Building the mounting plates for the hardware" class="dd-item ">
        <a href="/hardware/mounting-plates/">
        Mounting plates
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/hardware/jetson-nano-installation/" title="Preparing the Jetson Nano" class="dd-item ">
        <a href="/hardware/jetson-nano-installation/">
        Preparing the Jetson Nano
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/hardware/assembling-the-nano/" title="Assembling the Jetson Nano" class="dd-item ">
        <a href="/hardware/assembling-the-nano/">
        Assembling the Jetson Nano
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/hardware/connecting-the-car-to-the-nano/" title="Connecting the RC to the Nano" class="dd-item ">
        <a href="/hardware/connecting-the-car-to-the-nano/">
        Connecting the RC to the Nano
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/software/" title="Software" class="dd-item 
        
        
        
        ">
      <a href="/software/">
          <b>3. </b>Software
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/software/kernel-hacking/" title="Running the OS from an external SSD using a custom kernel" class="dd-item ">
        <a href="/software/kernel-hacking/">
        OPTIONAL: Kernel Hacking
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/software/donkeycar/" title="DonkeyCar" class="dd-item ">
        <a href="/software/donkeycar/">
        DonkeyCar: Explained
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/software/donkeycar-host/" title="DonkeyCar installation: Host PC" class="dd-item ">
        <a href="/software/donkeycar-host/">
        DonkeyCar: Host PC
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/software/donkeycar-simulator/" title="DonkeyCar Installation: The Simulator" class="dd-item ">
        <a href="/software/donkeycar-simulator/">
        DonkeyCar: Simulator
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/software/donkeycar-rc/" title="DonkeyCar installation: RC car" class="dd-item ">
        <a href="/software/donkeycar-rc/">
        DonkeyCar: RC car
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/software/setting-up-donkeycar-on-the-rc/" title="DonkeyCar configuration: RC car" class="dd-item ">
        <a href="/software/setting-up-donkeycar-on-the-rc/">
        DonkeyCar configuration: RC car
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/software/calibrating-steering-and-throttle/" title="Calibrating steering and throttle" class="dd-item ">
        <a href="/software/calibrating-steering-and-throttle/">
        Calibrating steering and throttle
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/software/connecting-a-bluetooth-gamepad/" title="Using a gamepad" class="dd-item ">
        <a href="/software/connecting-a-bluetooth-gamepad/">
        Using a gamepad
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/software/test-driving-the-rc/" title="Test drive" class="dd-item ">
        <a href="/software/test-driving-the-rc/">
        Test drive
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/software/sanity-check-first-autopilot/" title="First Autopilot: sanity check" class="dd-item ">
        <a href="/software/sanity-check-first-autopilot/">
        First Autopilot: sanity check
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/artificial-intelligence/" title="Artificial Intelligence" class="dd-item 
        
        
        
        ">
      <a href="/artificial-intelligence/">
          <b>4. </b>Artificial Intelligence
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/artificial-intelligence/custom-architecture/" title="Creating our first custom network architecture" class="dd-item ">
        <a href="/artificial-intelligence/custom-architecture/">
        First custom network architecture
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/artificial-intelligence/visualization/" title="Visualization" class="dd-item 
        
        
        
        ">
      <a href="/artificial-intelligence/visualization/">
          Visualization
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/artificial-intelligence/visualization/cnn-activations/" title="Visualization: CNN Activations" class="dd-item ">
        <a href="/artificial-intelligence/visualization/cnn-activations/">
        CNN Activations
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/artificial-intelligence/visualization/saliency-maps/" title="Visualization: Saliency Maps" class="dd-item ">
        <a href="/artificial-intelligence/visualization/saliency-maps/">
        Saliency Maps
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/artificial-intelligence/visualization/donkey-makemovie/" title="Visualization: donkey makemovie" class="dd-item ">
        <a href="/artificial-intelligence/visualization/donkey-makemovie/">
        Donkey makemovie
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/artificial-intelligence/simulator-mod/" title="Simulator modding" class="dd-item 
        
        
        
        ">
      <a href="/artificial-intelligence/simulator-mod/">
          Simulator modding
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/artificial-intelligence/simulator-mod/high-resolution-images/" title="Simulator mod: High resolution images" class="dd-item ">
        <a href="/artificial-intelligence/simulator-mod/high-resolution-images/">
        High res images
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/artificial-intelligence/simulator-mod/custom-rc-model/" title="Simulator mod: Custom RC model" class="dd-item ">
        <a href="/artificial-intelligence/simulator-mod/custom-rc-model/">
        Custom RC model
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/artificial-intelligence/camera-calibration/" title="Camera calibration" class="dd-item 
        
        
        
        ">
      <a href="/artificial-intelligence/camera-calibration/">
          Camera calibration
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/artificial-intelligence/camera-calibration/camera-distortions/" title="Camera calibration: Explaining camera distortions" class="dd-item ">
        <a href="/artificial-intelligence/camera-calibration/camera-distortions/">
        Camera distortions
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/artificial-intelligence/camera-calibration/implementing-camera-calibration/" title="Camera calibration: Implementing the calibration and undistortion" class="dd-item ">
        <a href="/artificial-intelligence/camera-calibration/implementing-camera-calibration/">
        Calibration implementation
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/artificial-intelligence/camera-calibration/calibrating-the-camera/" title="Camera calibration: Calibrating the camera and undistorting images" class="dd-item ">
        <a href="/artificial-intelligence/camera-calibration/calibrating-the-camera/">
        Calibrating your camera and undistorting images
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/artificial-intelligence/computer-vision-lane-finding/" title="Computer Vision: Lane Finding" class="dd-item ">
        <a href="/artificial-intelligence/computer-vision-lane-finding/">
        Computer Vision: Lane Finding
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/draft-and-todo/" title="Drafts and #TODO&#39;s" class="dd-item 
        parent
        
        
        ">
      <a href="/draft-and-todo/">
          <b>5. </b>Drafts and #TODO&#39;s
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/draft-and-todo/how-to-train-your-model/" title="Master recipe: How train your model" class="dd-item active">
        <a href="/draft-and-todo/how-to-train-your-model/">
        Master recipe: How train your model
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/draft-and-todo/derivacije/" title="Raspisivanje math-a" class="dd-item ">
        <a href="/draft-and-todo/derivacije/">
        Random math stuff
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/draft-and-todo/hough-transform/" title="Raspisivanje Hough transform-a" class="dd-item ">
        <a href="/draft-and-todo/hough-transform/">
        Hough transform stuff
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/draft-and-todo/integrating-the-lane-finding/" title="Integrating the lane finding with our model" class="dd-item ">
        <a href="/draft-and-todo/integrating-the-lane-finding/">
        Integrating the lane finding
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/draft-and-todo/adding-behaviours/" title="Adding behaviours: automated lane changing" class="dd-item ">
        <a href="/draft-and-todo/adding-behaviours/">
        Behaviours: Lane Changing
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/draft-and-todo/data-augmentation/" title="Augmenting the data with neural style transfer" class="dd-item ">
        <a href="/draft-and-todo/data-augmentation/">
        Data augmentation: ML meets art!
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/draft-and-todo/object-detection-and-tracking/" title="Detecting and tracking objects on images" class="dd-item ">
        <a href="/draft-and-todo/object-detection-and-tracking/">
        Object recognition and tracking
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/draft-and-todo/reinforcement-learning/" title="Reinforcement learning: letting the car learn to drive on its own" class="dd-item ">
        <a href="/draft-and-todo/reinforcement-learning/">
        Reinforcement learning
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    


    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fas fa-language fa-fw"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
                    
                    
                      <option id="en" value="https://ori.codes/draft-and-todo/how-to-train-your-model/" selected>English</option>
                    
                  
              
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      
	  
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
	  
    
      <section id="shortcuts">
        <h3></h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://github.com/ivanorsolic"><i class='fab fa-github'></i> Github</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://twitter.com/ivanorsolic"><i class='fab fa-twitter'></i> Twitter</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://ivanorsolic.github.io"><i class='fas fa-tasks'></i> Other stuff</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://drive.google.com/file/d/1c4F5kfnWZnwQciP8gKyKunzDOqBJ5gDM/view?usp=sharing"><i class='fas fa-file'></i> My CV</a>
              </li>
          
        </ul>
      </section>
    
      </ul>
    </section>
    
	
    <section id="footer">
      <p align="center">Built by <a href="https://twitter.com/ivanorsolic">Ori</a> with <a href="https://github.com/matcornic/hugo-theme-learn">Learn</i></a>, <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo.</a><br>
Hosted for free at <a href="https://app.netlify.com">Netlify <i class="fas fa-heart"></i></a>
</p>

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                   Master recipe: How train your model 
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#traindevtest-sets">Train/dev/test sets</a></li>
  </ul>

  <ul>
    <li><a href="#regularizing-neural-nets">Regularizing neural nets</a>
      <ul>
        <li><a href="#why-does-this-help">Why does this help?</a></li>
      </ul>
    </li>
    <li><a href="#dropout-regularization">Dropout regularization</a></li>
    <li><a href="#other-tips-to-prevent-overfittingbias">Other tips to prevent overfitting/bias</a>
      <ul>
        <li><a href="#augment-your-data">Augment your data</a></li>
        <li><a href="#how-to-solve-it">How to solve it</a></li>
        <li><a href="#early-stopping">Early stopping</a></li>
      </ul>
    </li>
    <li><a href="#iterating-quicker-a-single-number-performance-metric">Iterating quicker: a single number performance metric</a></li>
    <li><a href="#choosing-hyperparameters">Choosing Hyperparameters</a></li>
    <li><a href="#hyperparameters-can-get-stale">Hyperparameters can get stale</a></li>
    <li><a href="#how-to-train-your-model">How to train your model</a></li>
    <li><a href="#use-batch-norm">Use batch norm</a></li>
    <li><a href="#computational-graph-tf">COMPUTATIONAL GRAPH TF</a></li>
  </ul>

  <ul>
    <li><a href="#resnets">ResNets</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Master recipe: How train your model
            </h1>
          

        




<div class="notices warning" ><p>THIS IS A DRAFT</p>
</div>


<div class="notices info" ><p>Will publish in two or three days!</p>
</div>

<h2 id="traindevtest-sets">Train/dev/test sets</h2>
<ul>
<li>How many layers, hidden units, learning rates, what activation functions?</li>
<li>Iterate, iterate, iterate</li>
</ul>
<p><img src="/images/howtotrain/1574688039987.png" alt="1574688039987"></p>
<ul>
<li>Split the data into three parts: training set, cross validation set and test set.</li>
<li>You train the data on the training set, and validate it using the dev set.</li>
<li>Since you're using the dev set to tune the model hyperparameters, you're kinda fitting them to the data in the dev set. That's why after you've chosen the exact hyperparameters you want and after you've completely trained your model, you should test it using the test set, which is data it has never ever seen before, and should give you a &ldquo;real-world&rdquo; benchmark on how it performs.</li>
</ul>
<p>How to split the data:</p>
<ul>
<li>If you have a small amount of data, in the tens of thousands, you can use the &ldquo;olden&rdquo; way (pre big-data) of splitting the data: 60% for your training set, 20% for your dev and 20% for your test set</li>
<li>If however your data is in the millions, using 20% or 200 000 examples for your dev and test is surely a bit of an overkill. You can decide to use something like 10 000 examples for your dev/test sets, so you'd have a split of 99%/1%/1% for your train/dev/test sets respectively.</li>
<li>If your dataset is even bigger, you can also use something like 99.5%/0.4%/0.1%, whatever lets you quickly decide how well the model is training and performing on data it's never seen before.</li>
</ul>
<p><img src="/images/howtotrain/1574688740411.png" alt="1574688740411"></p>
<p>Make sure your training and dev/test sets come from the same distribution.</p>
<p>E.g. pictures of cats on web pages are mainly high res and quality, and users&rsquo; pictures can be blurry and low res/quality.</p>
<p>The main reason for people doing this is getting a bigger data set, so they crawl web pages or ..</p>
<p><img src="/images/howtotrain/1574689231474.png" alt="1574689231474"></p>
<p><img src="/images/howtotrain/1574689299815.png" alt="1574689299815"></p>
<p>High variance: the model is overfitting the training data and performing poorly on new unseen data.</p>
<p>High bias: the model isn't even performing well on the training data.</p>
<p>High bias and high variance: the model underfits the training data but performs even worse on the dev data.</p>
<p><img src="/images/howtotrain/1574689560387.png" alt="1574689560387"></p>
<p><strong>By looking at how well the model performs on the training data, you can see how much bias it has; if it has a low error, it has a low bias, if it has a large error, it has large bias.</strong></p>
<p><strong>By looking at how well the model performs on the dev set, you can see how much variance it has; if it performs much worse than on the training set, it has high variance, if it performs slightly worse or the same, it has low variance and generalizes well.</strong></p>
<h1 id="basic-recipe-for-learning-your-machines">Basic recipe for learning your machines</h1>
<ul>
<li>Get the model to perform well on the training data (low bias)</li>
<li>Get the model to perform well on the dev set data (low variance)</li>
</ul>
<p><strong>If you have large bias:</strong></p>
<ul>
<li>(Almost always works): Try a bigger network: more hidden layers, more hidden units.</li>
<li>(Sometimes works, but never hurts): Try training it longer: give it more time or use more advanced optimization algorithms.</li>
<li>(Maybe it'll work, maybe it won't): Try finding a better neural net architecture: try finding an architecture that's proven to work for your specific problem.</li>
<li>Consider asking yourself: is this even possible to do? If you're trying to train a classifier on very blurry low res images, is it even possible to do so? What's the base error for that problem?</li>
</ul>
<p><strong>If you have large variance:</strong></p>
<ul>
<li>(Best way to solve it): Get more data, it can only help. But sometimes it's impossible to get more data.</li>
<li>(Almost always helps): Regularization</li>
<li>(Maybe it'll work, maybe it won't): Try finding a better neural net architecture. Same as for the large bias problem.</li>
</ul>
<p><strong>Don't worry about the bias-variance tradeoff if you're doing deep learning. It isn't much of a thing anymore:</strong></p>
<ul>
<li>As long as you can train a bigger network (and use regularization), you'll almost certainly be able to get rid of high bias without increasing variance (by much).</li>
<li>As long as you can get more data (not always, but mostly possible), you'll almost certainly be able to get rid of high variance without increasing bias (by much).</li>
</ul>
<h2 id="regularizing-neural-nets">Regularizing neural nets</h2>
<p>To try and gain some intuition about regularization in neural nets, let's walk through implementing L2 regularization in a neural net. Since we're mostly doing computer vision stuff with our self-driving car, we'll most likely be using dropout regularization rather than L2, which is used much more often in computer vision, so feel free to skip this part if you're not interested.</p>
<p>If our cost function is defined as:</p>
<div>
++
\mathcal{J}(w^{[1]}, b^{[1]}, ..., w^{[l]}, b^{[l]}) = \frac{1}{n}\sum_{i=1}^{n}\mathcal{L}(\hat{y}^{(i)},y^{(i)})
++
</div>
We can regularize it by adding a regularization term:
<div>
++
\mathcal{J}(w^{[1]}, b^{[1]}, ..., w^{[l]}, b^{[l]}) = \frac{1}{n}\sum_{i=1}^{n}\mathcal{L}(\hat{y}^{(i)},y^{(i)}) + \frac{\lambda}{2n}\sum_{l=1}^l ||\mathcal{w}^{[l]}||^2
++
</div>
Let's break it down.
<p>The first part uses the regularization parameter $\lambda$, which is a hyperparameter to be tuned using the dev set, and divides it by $2n$, which is just a scaling constant.</p>
<p>The second part uses <a href="http://mathworld.wolfram.com/FrobeniusNorm.html">the Frobenius norm</a> (basically the L2 norm of a matrix), and it basically sums up the squares of all the elements of all $\mathcal{w}$ matrices we use:</p>
<div>
++
||\mathcal{w}^{[l]}||^2 = \sum_{i=1}^{n^{l}}\sum_{j=1}^{n^{[l-1]}}(\mathcal{w}_{i,j}^{[l]})^2
++
</div>
$\mathcal{w}$ is a $(n^{[l]}, n^{[l-1]})$ dimensional matrix, where the first dimension represents the number of units in the $l$-th layer, and the second represents the number of units in the previous layer.
<p>When implemented, during backprop the $W^{[l]}$ matrix gets multiplied by  $\frac{\lambda}{n}$, a number slightly smaller than 1, which is why it's also called weight decay, since the weight loses just a bit of it's value.</p>
<h3 id="why-does-this-help">Why does this help?</h3>
<p>If we set the $\lambda$ parameter in the regularization term below to a large value, it will set the values of $w^{[l]}$ very close to zero.</p>
<div>
++
\mathcal{J}(w^{[1]}, b^{[1]}, ..., w^{[l]}, b^{[l]}) = \frac{1}{n}\sum_{i=1}^{n}\mathcal{L}(\hat{y}^{(i)},y^{(i)}) + \frac{\lambda}{2n}\sum_{l=1}^l ||\mathcal{w}^{[l]}||^2
++
</div>
So what happens if $w^{[l]}$ is close to zero? It will cause $z^{[l]}$ to have a very small range of values, close to zero.
<div>
++
z^{[l]} = w^{[l]}a^{[l-1]}+b^{[l]}
++
</div>
Let's assume we're using $tanh(z)$ as our activation function.
<p><img src="/images/howtotrain/graph_20191126_142959.png" alt="graph_20191126_142959" style="zoom: 50%;" /></p>
<p>If the value of $z^{[l]}$ can be only a small range of values close to zero, our activation function will start looking like a linear function, as shown below:</p>
<p><img src="/images/howtotrain/image-20191126153603629.png" alt="image-20191126153603629" style="zoom:50%;" /></p>
<p>Which in turn means every layer in our neural net will begin to look like a linear layer, which will cause our network to be able to approximate only a linear function to our data, which will cause our model to go from high variance to high bias.</p>
<p>Of course, we don't (and won't) set our $\lambda$ parameter to a very large value, but rather set it to somewhere in between, which will get rid of our high variance problem and not cause high bias instead.</p>
<h2 id="dropout-regularization">Dropout regularization</h2>
<p><img src="/images/howtotrain/image-20191126154526865.png" alt="image-20191126154526865"></p>
<p>Imagine we have a neural net that looks like the one pictured above, on the left.</p>
<p>To stop our model from overfitting our data, we can randomly knock-out some neurons while training our model. This in turn causes the model to be unable to rely on just a particular set of neurons, or a pathway of neurons, so it has to train multiple subsets of neural nets, which makes it much more difficult to overfit the data, since it never knows when some of the neurons will be knocked out.</p>
<h2 id="other-tips-to-prevent-overfittingbias">Other tips to prevent overfitting/bias</h2>
<h3 id="augment-your-data">Augment your data</h3>
<p>Let's say we're training our car on the following track:</p>
<p>![Untitled design (/images/howtotrain/Untitled design (1)-1574780814518.png)](../Downloads/Untitled design (1).png)</p>
<p>We run a few laps on the track and save our data. If we've only driven in the usual, counter-clockwise direction, we have inadvertently caused our model to be slightly biased to always turn a bit to the left.</p>
<p>Why?</p>
<p><img src="/images/howtotrain/Untitled design.png" alt="Track"  /></p>
<p>We can see that, globally, the car is always turning a bit to the left. So if you only include this data in your training set, the car will always be inclined to turn just a bit to the left.</p>
<h3 id="how-to-solve-it">How to solve it</h3>
<p>Other than driving the very same track, just in the opposite direction, you can simply mitigate this issue by augmenting your data with the same images, just horizontally flipped, thus getting:</p>
<p>![Untitled design](/images/howtotrain/Untitled design-1574781029377.png)</p>
<p>Now your car shouldn't be inclined much to steer to one side or the other for no reason.</p>
<h3 id="early-stopping">Early stopping</h3>
<p>When training your model, you can often see the validation error getting lower over time, following the training error curve, but then at one moment you see it take off and get much worse over time:</p>
<p><img src="/images/howtotrain/early-stopping.png" alt="Image result for early stopping"></p>
<p>One possible solution is stopping the training early, when you see the validation error starting to increase.</p>
<p>Just keep in mind that by doing so, you're now coupling two problems that you were solving as separate before: the optimization of your cost function and the prevention of overfitting the dataset. By doing so, you're not doing quite the best job you could at minimizing the cost function, since it's obvious that the error could get much lower if the training wasn't stopped early, while you're simultaneously trying not to overfit your data.</p>
<p>One alternative could be using L2 regularization or some other regularization technique, but you can often see early stopping being used in practice. Just keep in mind the trade off you're doing.</p>
<h2 id="iterating-quicker-a-single-number-performance-metric">Iterating quicker: a single number performance metric</h2>
<p>First, lets define two terms using a classifier example; precision and recall.</p>
<p><strong>Precision:</strong> of the examples that your classifier recognizes as X, how many examples actually are X.
<strong>Recall:</strong> of the examples that are actually X, how many of them does your classifier recognize as X.</p>
<p>We can combine these two metrics into a single number, as a <a href="https://www.wikiwand.com/en/Harmonic_mean">harmonic mean</a> of the two, which is called <a href="https://www.wikiwand.com/en/F1_score">the F1 score</a>:</p>
<div>
++
F_1 = \frac{2}{\frac{1}{precision}+\frac{1}{recall}}
++
</div>
But why?
Sure, this doesn't help much if you're just using a binary classifier like mentioned above, to see if something is X or not. Or even if you're classifying things into two classes. 
<p>But imagine trying to decide between three implementations of a classifier with 3 possible classes:</p>
<table>
<thead>
<tr>
<th>Implementation/Classes</th>
<th>A (precision)</th>
<th>A (recall)</th>
<th>B (precision)</th>
<th>B (recall)</th>
<th>C (precision)</th>
<th>C (recall)</th>
</tr>
</thead>
<tbody>
<tr>
<td>First implementation</td>
<td>95%</td>
<td>90%</td>
<td>89%</td>
<td>88%</td>
<td>92%</td>
<td>89%</td>
</tr>
<tr>
<td>Second implementation</td>
<td>93%</td>
<td>89%</td>
<td>92%</td>
<td>90%</td>
<td>92%</td>
<td>90%</td>
</tr>
<tr>
<td>Third implementation</td>
<td>89%</td>
<td>88%</td>
<td>95%</td>
<td>93%</td>
<td>90%</td>
<td>89%</td>
</tr>
</tbody>
</table>
<p>Which one is the best? Sure isn't easy to tell from the table above. At least not to me.</p>
<p>Now look what it would look like if we used the F1 score for all of the possible classes:</p>
<table>
<thead>
<tr>
<th>Implementation/Classes</th>
<th>A ($F_1$ score)</th>
<th>B ($F_1$ score)</th>
<th>C ($F_1$ score)</th>
</tr>
</thead>
<tbody>
<tr>
<td>First implementation</td>
<td>92.4%</td>
<td>88.5%</td>
<td>90.5%</td>
</tr>
<tr>
<td>Second implementation</td>
<td>91%</td>
<td>91%</td>
<td>91%</td>
</tr>
<tr>
<td>Third implementation</td>
<td>88.5%</td>
<td>94%</td>
<td>89.5%</td>
</tr>
</tbody>
</table>
<p>Looks much simpler than the first table, but still could be simpler. Since we're probably interested in our classifier working as best as possible over all classes, we can take the average of all of the 3 $F_1$ scores to get one simple number that tells us how well our classifier works:</p>
<table>
<thead>
<tr>
<th>Implementation/Classes</th>
<th>Average $F_1$ score</th>
</tr>
</thead>
<tbody>
<tr>
<td>First implementation</td>
<td>90.5%</td>
</tr>
<tr>
<td>Second implementation</td>
<td>91%</td>
</tr>
<tr>
<td>Third implementation</td>
<td>90.7%</td>
</tr>
</tbody>
</table>
<p><strong>Why do this?</strong></p>
<p>The example above could've easily had a hundred different classes, with a dozen different implementations. That would've been impossible to look at even if you used $F_1$ scores for every class.</p>
<p>When trying out a bunch of different values of hyperparameters and implementation details, it's much faster to iterate and much easier to decide between all possible implementations when you have a single number that tells you how well it performs. And I believe this is a pretty good way to get one, even considering the amount of some fine-grained details you lose. You can always look them up after you eliminate some implementations, and have only a few you're actually considering.</p>
<p><strong>One important thing to notice is that there could be other important metrics to look at other than how accurate our classifier is.</strong></p>
<p>For an example, we could be making a classifier that classifies obstacles our car will collide with if we don't avoid them. Surely, we'd like to correctly classify as much of those as possible, so make a table, as the one above:</p>
<table>
<thead>
<tr>
<th>Classifier/Score</th>
<th>$F_1$ score</th>
</tr>
</thead>
<tbody>
<tr>
<td>First classifier</td>
<td>92%</td>
</tr>
<tr>
<td>Second classifier</td>
<td>97%</td>
</tr>
<tr>
<td>Third classifier</td>
<td>99%</td>
</tr>
</tbody>
</table>
<p>Cool, so we pick the third classifier. <strong>And our car crashes.</strong> Wait, wut?</p>
<p>We picked the best classifier in terms of it correctly classifying as much of the objects in our path as possible, but <strong>there's one thing we didn't look at;</strong> <strong>the time it takes it to classify an object.</strong></p>
<table>
<thead>
<tr>
<th>Classifier/Score</th>
<th>$F_1$ score</th>
<th>Average runtime</th>
</tr>
</thead>
<tbody>
<tr>
<td>First classifier</td>
<td>92%</td>
<td>20 ms</td>
</tr>
<tr>
<td>Second classifier</td>
<td>97%</td>
<td>70 ms</td>
</tr>
<tr>
<td>Third classifier</td>
<td>99%</td>
<td>3000 ms</td>
</tr>
</tbody>
</table>
<p>So yeah, we did recognize most of the objects we were on a collision path with, but by the time that we did, the car had already crashed into them.</p>
<p>Taking that in mind, the second classifier is obviously the better choice.</p>
<p>So it's important to keep in mind that while we're trying to optimize one of the metrics of our model, we also have to pay attention to the other minimum requirements the model must have in order to actually be usable in the real world, as per our real-time necessary example.</p>
<h2 id="choosing-hyperparameters">Choosing Hyperparameters</h2>
<p>Most important hyperparameters (in order):</p>
<ul>
<li>learning rate (alpha)</li>
<li>beta, number of hidden units, mini-batch size</li>
<li>number of layers, learning rate decay</li>
</ul>
<p>Random grid:</p>
<p><img src="/images/howtotrain/image-20191208195454506.png" alt="image-20191208195454506"></p>
<p>Coarse to fine - Zoom into best region:</p>
<p><img src="/images/howtotrain/image-20191208195519207.png" alt="image-20191208195519207"></p>
<p>What scale to use?</p>
<p>Use logarithmic scale</p>
<p><img src="/images/howtotrain/image-20191208201241739.png" alt="image-20191208201241739"></p>
<h2 id="hyperparameters-can-get-stale">Hyperparameters can get stale</h2>
<p>a lot more data</p>
<p>different network over time</p>
<p>new GPU/CPU</p>
<p>re-evaluate every once in a while</p>
<h2 id="how-to-train-your-model">How to train your model</h2>
<p><img src="/images/howtotrain/image-20191208201633729.png" alt="image-20191208201633729"></p>
<h2 id="use-batch-norm">Use batch norm</h2>
<p><img src="/images/howtotrain/image-20191208202254867.png" alt="image-20191208202254867"></p>
<h2 id="computational-graph-tf">COMPUTATIONAL GRAPH TF</h2>
<h1 id="why-convolutions">WHY CONVOLUTIONS</h1>
<p>Explain how to detect lane lines using edge detection and computer vision, explain why convolutions are better vs Sobel/Scharr filters:</p>
<p>Explain cross-correlation vs convolution:</p>
<p>To explain:</p>
<ul>
<li>Padding</li>
<li>Strides</li>
<li>Pooling</li>
<li>Visualize one example</li>
<li>Why Convolutions: zadnji video prvog tjedna</li>
</ul>
<h2 id="resnets">ResNets</h2>
<p>Explain exploding/vanishing gradients</p>


<footer class=" footline" >
	
</footer>


        
        </div> 
		
        
<script src="https://utteranc.es/client.js"
        repo="ivanorsolic/oriengineering"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/draft-and-todo/" title="Drafts and #TODO&#39;s"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/draft-and-todo/derivacije/" title="Raspisivanje math-a" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>
    </section>
    
		
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js"></script>
    <script src="/js/perfect-scrollbar.min.js"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js"></script>
    <script src="/js/jquery.sticky.js"></script>
    <script src="/js/featherlight.min.js"></script>
    <script src="/js/html5shiv-printshiv.min.js"></script>
    
    <script src="/js/modernizr.custom-3.6.0.js"></script>
    <script src="/js/learn.js"></script>
    <script src="/js/hugo-learn.js"></script>

    <link href="/mermaid/mermaid.css" rel="stylesheet" />
    <script src="/mermaid/mermaid.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
	
  </body>
</html>

